(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{378:function(e,a,t){"use strict";t.r(a);var n=t(25),s=Object(n.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"url重写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#url重写"}},[e._v("#")]),e._v(" URL重写")]),e._v(" "),t("p",[e._v("可以通过 URL 重写隐藏应用的入口文件"),t("code",[e._v("index.php")]),e._v(",下面是相关服务器的配置参考：")]),e._v(" "),t("h2",{attrs:{id:"apache"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apache"}},[e._v("#")]),e._v(" Apache")]),e._v(" "),t("ol",[t("li",[e._v("httpd.conf 配置文件中加载了 mod_rewrite.so 模块")]),e._v(" "),t("li",[e._v("AllowOverride None 将 None 改为 All")]),e._v(" "),t("li",[e._v("把下面的内容保存为 .htaccess 文件放到应用入口文件的同级目录下")]),e._v(" "),t("li",[e._v("配置文件 .htaccess 默认已在目录中存放了一份，可直接使用，所以步骤 3 可以省略。")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("<IfModule mod_rewrite.c>\n  Options +FollowSymlinks -Multiviews\n  RewriteEngine On\n\n  RewriteCond %{REQUEST_FILENAME} !-d\n  RewriteCond %{REQUEST_FILENAME} !-f\n  RewriteRule ^(.*)$ index.php?/$1 [QSA,PT,L]\n</IfModule>\n")])])]),t("h2",{attrs:{id:"nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[e._v("#")]),e._v(" Nginx")]),e._v(" "),t("p",[e._v("在 Nginx.conf 配置中，添加：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("location ~ \\.php(.*)$ {\n  fastcgi_pass   127.0.0.1:9000;\n  fastcgi_index  index.php;\n  fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n  fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n  fastcgi_param  PATH_INFO  $fastcgi_path_info;\n  fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n  include        fastcgi_params;\n}\n")])])]),t("p",[e._v("在 Nginx 低版本中，是不支持 PATHINFO 的，但是可以通过在 Nginx.conf 中配置转发规则实现。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("  location / { // …..省略部分代码\n   if (!-e $request_filename) {\n   rewrite  ^(.*)$  /index.php?s=/$1  last;\n   break;\n    }\n }\n")])])]),t("p",[e._v("一个完整的示例：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("server {\n        server_name careyshop.cn www.careyshop.cn *.careyshop.cn;\n        access_log  logs/www.careyshop.cn_access.log;\n        error_log   logs/www.careyshop.cn_error.log;\n        root        /var/www/html/www.careyshop.cn/public;\n\n        if ($host ~ www\\.(.*)\\.(.*)\\.(cn|com|net)$) {\n            return 444;\n        }\n\n        location / {\n            index  index.html index.htm index.php;\n            autoindex  off;\n            if (-f $request_filename) {\n              break;\n            }\n            if (!-e $request_filename) {\n              rewrite ^(.*)$ /index.php/$1 last;\n              break;\n            }\n        }\n        location ~ \\.php(.*)$ {\n            fastcgi_pass   127.0.0.1:9000;\n            fastcgi_index  index.php;\n            fastcgi_split_path_info  ^((?U).+\\.php)(/?.+)$;\n            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n            fastcgi_param  PATH_INFO  $fastcgi_path_info;\n            fastcgi_param  PATH_TRANSLATED  $document_root$fastcgi_path_info;\n            include        fastcgi_params;\n        }\n        location ~ /\\.ht {\n            deny  all;\n        }\n}\n")])])]),t("h2",{attrs:{id:"iis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iis"}},[e._v("#")]),e._v(" IIS")]),e._v(" "),t("p",[e._v("如果你的服务器环境支持 ISAPI_Rewrite 的话，可以配置 httpd.ini 文件，添加下面的内容：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("RewriteRule (.*)$ /index\\.php\\?s=$1 [I]\n")])])]),t("p",[e._v("在 IIS 的高版本下面可以配置 web.Config，在中间添加 rewrite 节点：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<rewrite>\n <rules>\n <rule name="OrgPage" stopProcessing="true">\n <match url="^(.*)$" />\n <conditions logicalGrouping="MatchAll">\n <add input="{HTTP_HOST}" pattern="^(.*)$" />\n <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />\n <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />\n </conditions>\n <action type="Rewrite" url="index.php/{R:1}" />\n </rule>\n </rules>\n</rewrite>\n')])])]),t("h2",{attrs:{id:"宝塔面板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#宝塔面板"}},[e._v("#")]),e._v(" 宝塔面板")]),e._v(" "),t("p",[e._v("如果使用了宝塔面板，在站点管理-设置中，伪静态选择"),t("code",[e._v("thinkphp")]),e._v("即可")])])}),[],!1,null,null,null);a.default=s.exports}}]);